<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[js]一文详解原型 | frontEnd blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="html, css, js, vue, node, react etc.">
    
    <link rel="preload" href="/assets/css/0.styles.a6409047.css" as="style"><link rel="preload" href="/assets/js/app.9b1dce4e.js" as="script"><link rel="preload" href="/assets/js/2.69d049f0.js" as="script"><link rel="preload" href="/assets/js/1.bddbc2d2.js" as="script"><link rel="preload" href="/assets/js/29.c5e72716.js" as="script"><link rel="prefetch" href="/assets/js/10.7247fb19.js"><link rel="prefetch" href="/assets/js/11.56ce2d6e.js"><link rel="prefetch" href="/assets/js/12.69ed3864.js"><link rel="prefetch" href="/assets/js/13.468ef051.js"><link rel="prefetch" href="/assets/js/14.81694906.js"><link rel="prefetch" href="/assets/js/15.93d60209.js"><link rel="prefetch" href="/assets/js/16.64cff392.js"><link rel="prefetch" href="/assets/js/17.3b4c7715.js"><link rel="prefetch" href="/assets/js/18.78f87d15.js"><link rel="prefetch" href="/assets/js/19.2a8ddc89.js"><link rel="prefetch" href="/assets/js/20.0589fe33.js"><link rel="prefetch" href="/assets/js/21.d08ce17b.js"><link rel="prefetch" href="/assets/js/22.d01cb373.js"><link rel="prefetch" href="/assets/js/23.bf6bd2cb.js"><link rel="prefetch" href="/assets/js/24.cdd8edcb.js"><link rel="prefetch" href="/assets/js/25.01bedff8.js"><link rel="prefetch" href="/assets/js/26.b7ce52ee.js"><link rel="prefetch" href="/assets/js/27.5e36e9c7.js"><link rel="prefetch" href="/assets/js/28.2143901f.js"><link rel="prefetch" href="/assets/js/3.2063a3a5.js"><link rel="prefetch" href="/assets/js/30.eccddeef.js"><link rel="prefetch" href="/assets/js/31.52998a0c.js"><link rel="prefetch" href="/assets/js/32.3dbdaa63.js"><link rel="prefetch" href="/assets/js/33.1ed3acdb.js"><link rel="prefetch" href="/assets/js/34.674053e4.js"><link rel="prefetch" href="/assets/js/35.3b956cd0.js"><link rel="prefetch" href="/assets/js/36.b4e74d1b.js"><link rel="prefetch" href="/assets/js/4.8d42542a.js"><link rel="prefetch" href="/assets/js/5.50f15e0f.js"><link rel="prefetch" href="/assets/js/6.7aacc445.js"><link rel="prefetch" href="/assets/js/7.6b7d0cec.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5a4296f1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a6409047.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="frontEnd blog" class="logo"> <span class="site-name can-hide">frontEnd blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">关于</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/css/" class="sidebar-heading clickable"><span>CSS篇</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/html/" class="sidebar-heading clickable"><span>HTML篇</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/js/" class="sidebar-heading clickable router-link-active open"><span>javascript篇</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/" aria-current="page" class="sidebar-link">第一篇【面试题】</a></li><li><a href="/js/README_02.html" aria-current="page" class="active sidebar-link">第二篇【详解js原型】</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vue/" class="sidebar-heading clickable"><span>vue篇</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/react/" class="sidebar-heading clickable"><span>react篇</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/backend/" class="sidebar-heading clickable"><span>后端篇(java、node、python)等</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/other/" class="sidebar-heading clickable"><span>其他</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js-一文详解原型"><a href="#js-一文详解原型" class="header-anchor">#</a> [js]一文详解原型</h1> <h2 id="一、前言"><a href="#一、前言" class="header-anchor">#</a> 一、前言</h2> <blockquote><p>相信大家对 js 原型（Prototype）并不陌生，无论是在面试的时候，还是日常的开发中都能碰到它。比如：在使用 Vue2 开发的时候你可能会为 Vue 添加一个全局接口请求的方法 <strong>Vue.prototype.$http = requestFun</strong>, 这样的话在每个 Vue 实例中都可以通过 <strong>this.$http</strong> 很方便快捷的访问这个方法，这里就是运用了 js 的原型。如果你对 js 原型的概念还比较模糊的话，那么接下来我将逐步详细为你介绍 js 原型到底是什么。</p></blockquote> <h2 id="二、从对象认识原型"><a href="#二、从对象认识原型" class="header-anchor">#</a> 二、从对象认识原型</h2> <p>字面量声明一个对象并打印这个对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你会发现除了属性 <strong>a</strong> 外还有一个 <strong>[[Prototype]]</strong> 属性，这个 obj.[[Prototype]] 就标识为 obj 的原型。</p> <p><img src="/js/02/01.png" alt="01"></p> <p>然而你不能直接通过 obj[&quot;[[Prototype]]&quot;] 访问这个原型。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span><span class="token string">'[[Prototype]]'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre></div><p>js 为对象提供了一个 <strong><strong>proto</strong></strong> 属性访问自身的原型</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>
</code></pre></div><p><img src="/js/02/02.png" alt="02"></p> <p>还提供了另一种方法 <strong>Object.getPrototypeOf</strong> 获取</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/js/02/02.png" alt="02"></p> <p>至此我们从对象认识到了什么是原型，以及如何获取一个对象的原型。</p> <h2 id="三、从构造函数认识原型"><a href="#三、从构造函数认识原型" class="header-anchor">#</a> 三、从构造函数认识原型</h2> <p>构造函数是通过 <strong>new</strong> 调用的方法。如下 <strong>SuperConstructor</strong> 就是一个构造函数。通过 new 一个构造函数创建一个构造函数实例对象 objInstance。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> objInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们都知道函数在 js 里面是引用类型也是一个对象，那么它是不是也有原型呢。我们打印 SuperConstructor 和 objInstance 来看下。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>SuperConstructor<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>objInstance<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>不出所料他两都有原型</p> <p><img src="/js/02/03.png" alt="03"></p> <p>眼尖的你不知道有没有发现 SuperConstructor 有个属性 <strong>prototype</strong>，你会发现由 SuperConstructor 构造函数创建出来的实例对象的原型与该构造函数的 prototype 的属性相等。</p> <p><img src="/js/02/04.png" alt="04"></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">SuperConstructor</span><span class="token punctuation">.</span>prototype <span class="token operator">==</span>  objInstance<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>所以可以得出结论：构造函数有一个 prototype 属性指向由构造函数创建的实例的原型。</p> <p>还有一个需要注意的是，构造函数的 prototype 同样有个 constructor 属性指向构造函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">SuperConstructor</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">==</span> SuperConstructor<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><h2 id="四、继承属性和方法"><a href="#四、继承属性和方法" class="header-anchor">#</a> 四、继承属性和方法</h2> <blockquote><p>至此我们得知对象、原型、构造函数三者之间的关系。我们再来看看原型有什么作用。利用原型继承属性</p></blockquote> <p>如下案例：obj2 本来是没有属性 a、b 以及方法 print，但是通过改变 obj2 的原型 <strong>proto</strong> 指向为 obj，由此 obj2 “继承”了 obj 的属性。obj2 访问 a、b、print 的过程为：首先会在 obj2 这个对象上找，很显然 obj2 没这几个值，下一步会在 obj2 的原型 [[prototype]] 上找，上面有讲到 [[prototype]] 即为 <strong>proto</strong>，所以在 obj 上找有么有这几个属性和方法，正好找到了，结束查找。如果没有找到会接着在 obj 的原型上找，如果 obj 的原型上没有会接着在 obj 原型的原型上找，直到访问到 null。至于什么时候到 null，后面再详细介绍。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token function-variable function">print</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'被调用了~'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> 
    <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token literal-property property">__proto__</span><span class="token operator">:</span> obj
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token comment">// 3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>d<span class="token punctuation">)</span> <span class="token comment">// 4</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>a<span class="token punctuation">)</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token comment">// 2</span>
obj2<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 被调用了~</span>
</code></pre></div><h2 id="五、原型链"><a href="#五、原型链" class="header-anchor">#</a> 五、原型链</h2> <blockquote><p>原型链其实是个抽象概念，可以想象成由多个原型（prototype）串起来来的链子。这个链子有头部和尾部，尾部就是上面提到的为 null 的时候。</p></blockquote> <p>我们来看个例子：我们通过 obj4 访问 a 属性的查找过程为 obj4 -&gt; obj4 的原型（obj3）-&gt; obj3 的原型（obj2）-&gt; obj2 的原型（obj），以上这个查找过程就形成了一个 “链子”，当查找 f 属性的时候由于 obj 上没这个属性所以会接着在 obj 的原型 Object 上找，obj 的原型上也没找到，接着继续在 obj 原型（Object）的原型（null）上找，但是 obj 原型（Object）的原型为 null，所以 obj4.f 返回 undefined。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token literal-property property">__proto__</span><span class="token operator">:</span> obj
<span class="token punctuation">}</span>

<span class="token keyword">let</span> obj3 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token literal-property property">__proto__</span><span class="token operator">:</span> obj2
<span class="token punctuation">}</span>

<span class="token keyword">let</span> obj4 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token literal-property property">__proto__</span><span class="token operator">:</span> obj3
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj4<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj4<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>

</code></pre></div><h2 id="六、在构造函数上修改原型"><a href="#六、在构造函数上修改原型" class="header-anchor">#</a> 六、在构造函数上修改原型</h2> <blockquote><p>在上面的案例中我们都是直接修改对象的 <strong>proto</strong> 来改变原型，接下来我们通过构造函数修改。</p></blockquote> <p>通过修改构造函数的 prototype 属性，来修改构造函数实例的原型（[[prototype]]）</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">function</span> <span class="token function">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$http</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'http 请求~'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
instance<span class="token punctuation">.</span><span class="token function">$http</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// http 请求~</span>
</code></pre></div><h2 id="七、总结"><a href="#七、总结" class="header-anchor">#</a> 七、总结</h2> <p>每个引用类型数据都有一个属性（<strong>proto</strong>）指向它的原型，构造函数有个 prototype 指向构造函数实例的原型，而且这个原型有个 constructor 属性指向实例的构造函数。
通过对象、构造函数、原型之间的关系，我们可以利用原型继承扩展对象的功能，扩展指定的属性和方法。
查找对象属性的过程我们直到了原型链的概念使我们对原型的概念更加清晰。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">2024-03-19 21:37:11</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/js/" class="prev router-link-active">
        第一篇【面试题】
      </a></span> <span class="next"><a href="/vue/">
        第一篇
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9b1dce4e.js" defer></script><script src="/assets/js/2.69d049f0.js" defer></script><script src="/assets/js/1.bddbc2d2.js" defer></script><script src="/assets/js/29.c5e72716.js" defer></script>
  </body>
</html>
